## 长度扩展实验
wangqi
# 实验步骤
1.随机生成一个要计算hash值的消息m，用SM3函数算出hash值，将该值记为hash1/n
2.生成一个附加消息m'用以长度扩展攻击
3.首先用hash1算出加密结束后8个向量的值，再以它们作为初始向量，去加密m'，得到另一个hash值，将该hash值记为hash2
4.计算m + padding + m'的hash值,将该hash值记为hash3，如果hash2应该和hash3相等，则可以证明长度扩展攻击所得的hash值即为m + padding + m'的正常hash值，此时可知攻击成功
# 攻击原理
SM3的消息长度是64字节或者它的倍数，如果消息的长度不足则需要padding。在padding时，首先填充一个1，随后填充0，直到消息长度为56(mod 64)字节，最后8字节用来填充消息的长度。在SM3函数计算时，首先对消息进行分组，每组64字节，每一次加密一组，并更新8个初始向量,初始向量初始值固定即为IV，下一次用新向量去加密下一组。利用这一特性去实现长度扩展攻击。当我们得到一次加密后的向量值时，构造一组消息m'用于下一次加密，就可以在不知道m的情况下得到合法的hash值,从而实现长度扩展攻击。

